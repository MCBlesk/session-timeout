!function(n,e){"use strict";n.widget("apex.apex_session_timeout",{options:{timeoutAction:null,timeoutMessage:null,timeoutURL:null,logoutURL:null,showWarning:null,showWarningMiliBefore:null,showWarningTitle:null,showWarningMessage:null,hideHistory:!1,sessionIdleDuration:null,maskBrowser:null,ajaxIdentifier:null,keepSessionAlive:null,debug:!0},_create:function(){var e=this;if(apex.debug("Session Timeout: _create (start)"),apex.debug("...Options"),e.options.debug)for(name in e.options)apex.debug("......"+name+': "'+e.options[name]+'"');e._createPrivateStorage(),e._startTimers(),e.options.keepSessionAlive&&(e._startIdleMonitor(),e._startPingTimer()),apex.debug("Session Timeout: _create (end)")},_startPingTimer:function(){var e=this;apex.debug("Session Timeout: _startSessionPingTimer (start)"),e._values.pingID=setTimeout(function(){e._handlePing()},e._values.pingFrequency),apex.debug("Session Timeout: _startSessionPingTimer (end)")},_startIdleMonitor:function(){var e=this;apex.debug("Session Timeout: _startIdleMonitor (start)"),n.idleTimer(e._values.checkIdleFrequency),n(document).bind("idle.idleTimer",function(){apex.debug("Session Timeout: session inactive!")}),n(document).bind("active.idleTimer",function(){apex.debug("Session Timeout: session active!)"),e._pingSession()}),apex.debug("Session Timeout: _startIdleMonitor (end)")},_createPrivateStorage:function(){apex.debug("Session Timeout: _createPrivateStorage (start)"),this._values={docTitle:document.title,titleBlinkIntervalID:null,titleBlinkInterval:8e3,warningID:null,timeoutID:null,pingID:null,checkIdleFrequency:6e4,pingFrequency:6e4,isWarned:!1,timeoutActionEnum:{ALERT:"ALERT",REDIRECT:"REDIRECT",LOGOUT:"LOGOUT"}},this._elements={$dialog:{}},apex.debug("Session Timeout: _createPrivateStorage (end)")},_startTimers:function(){var e=this;apex.debug("Session Timeout: startTimer (start)"),e.options.showWarning&&(e._values.warningID=setTimeout(function(){e._warn()},e.options.sessionIdleDuration-e.options.showWarningMiliBefore),apex.debug("...initializing warning timeout("+e._values.warningID+")")),e._values.timeoutID=setTimeout(function(){e._handleExpiredSession()},e.options.sessionIdleDuration),apex.debug("...initializing idle timeout("+e._values.timeoutID+")"),apex.debug("Session Timeout: startTimer (end)")},_stopTimers:function(){var e=this;apex.debug("Session Timeout: _stopTimers (start)"),e.options.keepSessionAlive&&e._values.timeoutID&&null!==e._values.timeoutID&&(apex.debug("...clearng idle timeout("+e._values.timeoutID+")"),clearTimeout(e._values.timeoutID),e._values.timeoutID=null),e.options.showWarning&&e._values.warningID&&null!==e._values.warningID&&(apex.debug("...clearng warning timeout("+e._values.warningID+")"),clearTimeout(e._values.warningID),e._values.warningID=null),apex.debug("Session Timeout: _stopTimers (end)")},_handleExpiredSession:function(){var e=this;apex.debug("Session Timeout: _handleExpiredSession (start)"),e.options.maskBrowser&&e._showMask(),setTimeout(function(){e._expireAction()},100),apex.debug("Session Timeout: _handleExpiredSession (end)")},_expireAction:function(){var e=this;apex.debug("Session Timeout: _expireAction (start)"),e.options.timeoutAction===e._values.timeoutActionEnum.ALERT?(alert(e.options.timeoutMessage),e._redirect(e.options.timeoutURL)):e.options.timeoutAction===e._values.timeoutActionEnum.REDIRECT?e._redirect(e.options.timeoutURL):e.options.timeoutAction===e._values.timeoutActionEnum.LOGOUT&&e._redirect(e.options.logoutURL),apex.debug("Session Timeout: _expireAction (end)")},_warn:function(){var e=this;apex.debug("Session Timeout: _warn (start)");var i='<div class="session-timeout-container ui-widget">   <p>'+e.options.showWarningMessage+"</p></div>";n("body").append(i),e._elements.$dialog=n(".session-timeout-container"),e._elements.$dialog.dialog({disabled:!1,autoOpen:!0,buttons:{Ok:function(){n(this).dialog("close")}},closeOnEscape:!0,closeText:"Close",dialogClass:"session-timeout-dialog",draggable:!0,height:"auto",hide:null,maxhHeight:!1,maxWidth:!1,minHeight:100,minWidth:200,modal:!0,resizable:!1,show:null,stack:!0,title:e.options.showWarningTitle,close:function(){e._closeWarning()}}),e._startTitleBlink(),e._values.isWarned=!0,e.options.keepSessionAlive&&n.idleTimer("destroy"),apex.debug("Session Timeout: _warn (end)")},_closeWarning:function(){var e=this;apex.debug("Session Timeout: _closeWarning (start)"),e._elements.$dialog.dialog("destroy"),e._elements.$dialog.remove(),e._stopBlink(),e._stopTimers(),e._values.isWarned=!1,e.options.keepSessionAlive&&(e._pingSession(),e._startIdleMonitor()),apex.debug("Session Timeout: _closeWarning (end)")},_startTitleBlink:function(){var e=this;apex.debug("Session Timeout: _startTitleBlink (start)"),e._titleBlink(),e._values.titleBlinkIntervalID=setInterval(function(){e._titleBlink()},e._values.titleBlinkInterval),apex.debug("Session Timeout: _startTitleBlink (end)")},_titleBlink:function(){var e=this;apex.debug("Session Timeout: _titleBlink (start)"),document.title=e.options.showWarningTitle,setTimeout(function(){document.title=e._values.docTitle},500),apex.debug("Session Timeout: _titleBlink (end)")},_stopBlink:function(){apex.debug("Session Timeout: _stopBlink (start)"),document.title=this._values.docTitle,clearInterval(this._values.titleBlinkIntervalID),apex.debug("Session Timeout: _stopBlink (end)")},_redirect:function(e){apex.debug("Session Timeout: _redirect (start)"),this.options.hideHistory?window.location.replace(e):window.location.href=e,apex.debug("Session Timeout: _redirect (end)")},_showMask:function(){var e=n(document).height(),i=n(window).width(),t=n(document.createElement("div")).attr("id","session-timeout-mask").css({width:i,height:e});apex.debug("Session Timeout: _showMask (start)"),apex.debug("...maskHeight:"+e),apex.debug("...maskWidth:"+i),n("body").append(t),n(window).resize(function(){var e=n(document).height(),i=n(window).width();n("#session-timeout-mask").css({width:i,height:e})}),apex.debug("Session Timeout: _showMask (end)")},_handlePing:function(){apex.debug("Session Timeout: _handlePing (start)"),"active"===n.data(document,"idleTimer")?(apex.debug("session is active. Refreshing server session"),this._pingSession()):apex.debug("session is inactive. Do not refresh server session."),apex.debug("Session Timeout: _handlePing (end)")},_pingSession:function(){var i=this;apex.debug("Session Timeout: _pingSession (start)"),e(i.options.ajaxIdentifier,{},{dataType:"text",success:function(e){apex.debug("Ajax request successful"),clearTimeout(i._values.pingID),i._startPingTimer(),i._stopTimers(),i._startTimers()}}),apex.debug("Session Timeout: _pingSession (end)")}})}(apex.jQuery,apex.server.plugin);
//# sourceMappingURL=maps/apex-session-timeout.min.js.map
